Binanry-only Fuzz
===
ðŸ”™ [MENU README](./README.md)

# Binanry-only Fuzz
1. ç¾å¯¦ç’°å¢ƒä¸­é‡åˆ°çš„ç¨‹å¼å¤§å¤šæ²’æœ‰åŽŸå§‹ç¢¼
   - å•†ç”¨è»Ÿé«”ä¸æœƒé–‹æ”¾åŽŸå§‹ç¢¼
2. é‚£è¦å¦‚ä½•é‡å°åŸ·è¡Œæª”åšfuzz
   - Static binary rewriting
   - Dynamic binary instrumentation(DBI)

---

# Static binary rewriting
## Trampoline
1. Trampolineæ˜¯å½ˆè·³åºŠçš„æ„æ€ï¼Œé¡§åæ€ç¾©
   å°±æ˜¯è·³å‡ºåŽ»è¨ˆç®—Coverageå¾Œå†è·³å›žä¾†
2. å°‡basic blocké–‹é ­çš„instructionæ”¹æˆcall/jmpï¼Œä¸¦è·³åˆ°æŒ‡å®šä½å€
   - **åœ¨æŒ‡å®šä½å€æœƒæ”¾è’é›†Coverageçš„instruction**
   - åŒæ™‚ä¹ŸæœƒåŸ·è¡ŒåŽŸæœ¬çš„ç¨‹å¼
   - æœ€å¾Œè·³å›žåŽ»
3. é€™ä¹Ÿæ˜¯æƒ¡æ„ç¨‹å¼ä¸­å¾ˆå¸¸ç”¨åˆ°çš„æŠ€å·§ï¼Œå¾ˆå¤šæƒ¡æ„ç¨‹å¼çš„æ··æ·†æ–¹å¼æ˜¯
   æœƒåœ¨åŸ·è¡Œä¸­å‹•æ…‹ä¿®æ”¹è‡ªå·±çš„ç¨‹å¼ç¢¼ï¼Œå…¶ä¸­ä¸€ç¨®æ–¹å¼å°±æ˜¯
   å°‡basic blocké–‹é ­çš„instructionæ”¹æˆcall/jmp
   å°Žè‡´åœ¨åŸ·è¡Œçš„æ™‚å€™æœƒè·³åˆ°å…¶ä»–åœ°æ–¹åŽ»åŸ·è¡Œ

   ![](./_src/Trampoline.png)

4. Trampolineçš„è¡ä¼¸å•é¡Œ
   - å¦‚æžœcall/jmpçš„æŒ‡ä»¤æ¯”åŽŸæœ¬çš„basic blocké‚„é•·æ€Žéº¼è¾¦?
   - Trampolineçš„ç¨‹å¼ç¢¼è¦æ”¾åœ¨å“ªè£¡?
   - å¦‚æžœé€™å€‹basic blockè¦å­˜å–è¨˜æ†¶é«”ä¸­çš„ç›¸å°ä½ç½®ï¼Œè¦æ€Žéº¼å–?
   - è¢«patchæŽ‰çš„æŒ‡ä»¤è¦æ€Žéº¼åŸ·è¡Œã€åœ¨å“ªè£¡åŸ·è¡Œ?

## Reassemble
```
æ ¸å¿ƒæ¦‚å¿µ: æŠŠåŽŸæœ¬çš„çµ„åˆèªžè¨€ä¿®æ”¹å¾Œï¼Œå†é‡æ–°çµ„è­¯å›žåŸ·è¡Œæ“‹
         ä¸¦ç¢ºä¿ç¨‹å¼åŸ·è¡Œæµç¨‹ä»èˆ‡åŽŸæœ¬ç›¸åŒ
```

![](./_src/Reassemble.png)

---


# Dynamic binary instrumentation(DBI)
1. DBIé¡§åæ€ç¾©å°±æ˜¯åœ¨åŸ·è¡Œçš„éŽç¨‹ä¸­ï¼Œ**å‹•æ…‹çš„åŸ·è¡Œæ’æ¨ç¨‹å¼ç¢¼**
   - å› æ­¤ä¸èƒ½ç›´æŽ¥åŸ·è¡Œåœ¨ç³»çµ±ä¸Š
2. DBIé€šå¸¸ä½¿ç”¨å¦ä¸€éš»ç¨‹å¼ä¾†**æ¨¡æ“¬**ç³»çµ±/ç¨‹å¼çš„åŸ·è¡Œ
   - å¯ä»¥æƒ³åƒæˆä½¿ç”¨è™›æ“¬æ©Ÿä¾†åŸ·è¡Œç¨‹å¼
     ä¸¦åœ¨è™›æ“¬æ©Ÿä¸­æ›´æ”¹å®ƒè¦åŸ·è¡Œçš„ç¨‹å¼ç¢¼
3. DBIå·¥å…·
   - QEMU(AFL-qemu) : è¼•é‡åŒ–è™›æ“¬æ©Ÿ
   - Intel PIN
   - DynamoRIO

![](./_src/QEMUStructure.png)
> QEMU IR : QEMUè‡ªå·±ç”¨çš„çµ„åˆèªžè¨€
> QEMU Deviceæœƒè·ŸçœŸæ­£çš„ç¡¬é«”æœ‰ä¸€äº›äº’å‹•